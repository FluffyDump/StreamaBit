2024-11-07 00:09:03.462 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000013A25C9C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000013A26064950>
    └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000013A2787BBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000013A21F64860>
    └ <WorkerThread(AnyIO worker thread, started 33696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000013A2776C400>
    └ <WorkerThread(AnyIO worker thread, started 33696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x0000013A276C2660>, db=<sqlalchemy.orm.session.Session object at 0x0000013A277178...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000013A276C7D40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x0000013A27717850>
           │             └ <function remove_user at 0x0000013A2734EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x0000013A27717850>
    │           └ <function commit at 0x0000013A2734EA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x0000013A25F699E0>
           └ <sqlalchemy.orm.session.Session object at 0x0000013A27717850>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000013A25F68AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000013A262975C0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000013A262975C0>
                └ <function SessionTransaction.commit at 0x0000013A25F68900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000013A25F687C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000013A262975C0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000013A262975C0>
                └ <function SessionTransaction._prepare_impl at 0x0000013A25F68720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000013A25F74900>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000013A27717850>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000013A262975C0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000013A25F74AE0>
    └ <sqlalchemy.orm.session.Session object at 0x0000013A27717850>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000013A278BF400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000013A25F593A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000013A2785FF50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000013A2785FF50>
    │   └ <function SaveUpdateAll.execute at 0x0000013A25F59EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000013A25F05A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x0000013A25F500E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x0000013A25BD8360>
        └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x0000013A278BE8D0>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000013A25BD8680>
           └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000013A25BD8860>
          └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000013A25BD8900>
           └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000013A25BD8B80>
    └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000013A25C9C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000013A26064950>
    └ <sqlalchemy.engine.base.Connection object at 0x0000013A2784F550>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000013A2787BBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:10:30.008 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000142689EC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000014268DB4510>
    └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001426A5CFBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000014264C44860>
    └ <WorkerThread(AnyIO worker thread, started 21952)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001426A4B8400>
    └ <WorkerThread(AnyIO worker thread, started 21952)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001426A412660>, db=<sqlalchemy.orm.session.Session object at 0x0000014268F007...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001426A459300>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x0000014268F007D0>
           │             └ <function remove_user at 0x00000142690CEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x0000014268F007D0>
    │           └ <function commit at 0x00000142690CEA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x0000014268CB99E0>
           └ <sqlalchemy.orm.session.Session object at 0x0000014268F007D0>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000014268CB8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001426A454DC0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001426A454DC0>
                └ <function SessionTransaction.commit at 0x0000014268CB8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000014268CB87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001426A454DC0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001426A454DC0>
                └ <function SessionTransaction._prepare_impl at 0x0000014268CB8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000014268CC4900>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000014268F007D0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001426A454DC0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000014268CC4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x0000014268F007D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001426A60F400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000014268CA93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001426A5AF6D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001426A5AF6D0>
    │   └ <function SaveUpdateAll.execute at 0x0000014268CA9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000014268C55A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x0000014268CA00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x0000014268928360>
        └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x000001426A60E850>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000014268928680>
           └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000014268928860>
          └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000014268928900>
           └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000014268928B80>
    └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000142689EC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000014268DB4510>
    └ <sqlalchemy.engine.base.Connection object at 0x000001426A59F010>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001426A5CFBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:25:01.752 | ERROR    | app.services.user_service:remove_user:143 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001BE7FACC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001BE7FE94850>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001BE016BBAE0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001BE7BCF4860>
    └ <WorkerThread(AnyIO worker thread, started 16448)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001BE0127C400>
    └ <WorkerThread(AnyIO worker thread, started 16448)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001BE011D2660>, db=<sqlalchemy.orm.session.Session object at 0x000001BE0120B8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001BE012277C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001BE0120B890>
           │             └ <function remove_user at 0x000001BE001CEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.flush(db)
    │           │     └ <sqlalchemy.orm.session.Session object at 0x000001BE0120B890>
    │           └ <function flush at 0x000001BE001CE980>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 4, in flush
    return db.flush()
           │  └ <function Session.flush at 0x000001BE7FDA4900>
           └ <sqlalchemy.orm.session.Session object at 0x000001BE0120B890>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001BE7FDA4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x000001BE0120B890>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001BE016FEF80>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001BE7FD893A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001BE01214510>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001BE01214510>
    │   └ <function SaveUpdateAll.execute at 0x000001BE7FD89EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001BE7FD35A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x000001BE7FD800E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x000001BE7FA08360>
        └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x000001BE016FE3D0>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001BE7FA08680>
           └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001BE7FA08860>
          └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001BE7FA08900>
           └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001BE7FA08B80>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001BE7FACC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001BE7FE94850>
    └ <sqlalchemy.engine.base.Connection object at 0x000001BE011E1A50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001BE016BBAE0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:26:49.179 | ERROR    | app.crud.user_crud:delete:147 - Exception with user_id=80: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000017C80AEC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017C80EB47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000017C826BFBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 137, in delete
    db.commit()
    │  └ <function Session.commit at 0x0000017C80DB99E0>
    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000017C80DB8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
                └ <function SessionTransaction.commit at 0x0000017C80DB8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000017C80DB87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
                └ <function SessionTransaction._prepare_impl at 0x0000017C80DB8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000017C80DC4900>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000017C80DC4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000017C82703200>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000017C80DA93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000017C82215650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000017C82215650>
    │   └ <function SaveUpdateAll.execute at 0x0000017C80DA9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000017C80D55A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x0000017C80DA00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x0000017C80A28360>
        └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x0000017C82702510>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000017C80A28680>
           └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000017C80A28860>
          └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000017C80A28900>
           └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000017C80A28B80>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000017C80AEC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017C80EB47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000017C826BFBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000017CFCD44860>
    └ <WorkerThread(AnyIO worker thread, started 30248)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000017C82278400>
    └ <WorkerThread(AnyIO worker thread, started 30248)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x0000017C811FA700>, db=<sqlalchemy.orm.session.Session object at 0x0000017C822233...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000017C82221AC0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
           │             └ <function remove_user at 0x0000017C811CEE80>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 137, in remove_user
    user_crud.delete(db=db, user_id=db_user.user_id)
    │         │         │           │       └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000017C81087600>
    │         │         │           └ <app.models.database.User object at 0x0000017C8269F950>
    │         │         └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
    │         └ <function delete at 0x0000017C811CEAC0>
    └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 141, in delete
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 00:26:49.202 | ERROR    | app.services.user_service:remove_user:143 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000017C80AEC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017C80EB47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000017C826BFBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 137, in delete
    db.commit()
    │  └ <function Session.commit at 0x0000017C80DB99E0>
    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x0000017C80DB8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
                └ <function SessionTransaction.commit at 0x0000017C80DB8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x0000017C80DB87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
                └ <function SessionTransaction._prepare_impl at 0x0000017C80DB8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x0000017C80DC4900>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000017C82640FF0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x0000017C80DC4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000017C82703200>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x0000017C80DA93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000017C82215650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000017C82215650>
    │   └ <function SaveUpdateAll.execute at 0x0000017C80DA9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000017C80D55A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x0000017C80DA00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x0000017C80A28360>
        └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x0000017C82702510>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000017C80A28680>
           └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000017C80A28860>
          └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000017C80A28900>
           └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000017C80A28B80>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x0000017C80AEC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x0000017C80EB47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000017C8268ED50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000017C826BFBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 141, in delete
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000017CFCD44860>
    └ <WorkerThread(AnyIO worker thread, started 30248)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000017C82278400>
    └ <WorkerThread(AnyIO worker thread, started 30248)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x0000017C811FA700>, db=<sqlalchemy.orm.session.Session object at 0x0000017C822233...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000017C82221AC0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
           │             └ <function remove_user at 0x0000017C811CEE80>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 137, in remove_user
    user_crud.delete(db=db, user_id=db_user.user_id)
    │         │         │           │       └ <sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x0000017C81087600>
    │         │         │           └ <app.models.database.User object at 0x0000017C8269F950>
    │         │         └ <sqlalchemy.orm.session.Session object at 0x0000017C82223350>
    │         └ <function delete at 0x0000017C811CEAC0>
    └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 148, in delete
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 00:30:18.783 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000140F4C2C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000140F4FF47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x00000140F680BBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000140F0ED4860>
    └ <WorkerThread(AnyIO worker thread, started 27356)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x00000140F66F84A0>
    └ <WorkerThread(AnyIO worker thread, started 27356)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x00000140F6652660>, db=<sqlalchemy.orm.session.Session object at 0x00000140F66744...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x00000140F6691880>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x00000140F6674450>
           │             └ <function remove_user at 0x00000140F530EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x00000140F6674450>
    │           └ <function commit at 0x00000140F530EA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x00000140F4EF99E0>
           └ <sqlalchemy.orm.session.Session object at 0x00000140F6674450>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x00000140F4EF8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000140F66FF5C0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000140F66FF5C0>
                └ <function SessionTransaction.commit at 0x00000140F4EF8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x00000140F4EF87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000140F66FF5C0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000140F66FF5C0>
                └ <function SessionTransaction._prepare_impl at 0x00000140F4EF8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x00000140F4F04900>
    │    └ <sqlalchemy.orm.session.Session object at 0x00000140F6674450>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x00000140F66FF5C0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x00000140F4F04AE0>
    └ <sqlalchemy.orm.session.Session object at 0x00000140F6674450>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x00000140F684F500>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x00000140F4EE93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x00000140F6657B10>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x00000140F6657B10>
    │   └ <function SaveUpdateAll.execute at 0x00000140F4EE9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x00000140F4E95A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x00000140F4EE00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x00000140F4B68360>
        └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x00000140F684E950>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x00000140F4B68680>
           └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x00000140F4B68860>
          └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x00000140F4B68900>
           └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x00000140F4B68B80>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000140F4C2C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000140F4FF47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x00000140F67DF2D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x00000140F680BBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:36:00.343 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000274811EC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000274815B47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000027482DCFBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000274FD4B4860>
    └ <WorkerThread(AnyIO worker thread, started 32208)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000027482CB84A0>
    └ <WorkerThread(AnyIO worker thread, started 32208)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x0000027482C12660>, db=<sqlalchemy.orm.session.Session object at 0x0000027482C4B8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000027482CC2EC0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x0000027482C4B890>
           │             └ <function remove_user at 0x000002748289EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x0000027482C4B890>
    │           └ <function commit at 0x000002748289EA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x00000274814B99E0>
           └ <sqlalchemy.orm.session.Session object at 0x0000027482C4B890>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x00000274814B8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027482C54DC0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027482C54DC0>
                └ <function SessionTransaction.commit at 0x00000274814B8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x00000274814B87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027482C54DC0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027482C54DC0>
                └ <function SessionTransaction._prepare_impl at 0x00000274814B8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x00000274814C4900>
    │    └ <sqlalchemy.orm.session.Session object at 0x0000027482C4B890>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x0000027482C54DC0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x00000274814C4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x0000027482C4B890>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x0000027482C203C0>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x00000274814A93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000027482D9DE90>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x0000027482D9DE90>
    │   └ <function SaveUpdateAll.execute at 0x00000274814A9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x0000027481455A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x00000274814A00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x0000027481128360>
        └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x0000027482E16610>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x0000027481128680>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x0000027481128860>
          └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x0000027481128900>
           └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x0000027481128B80>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x00000274811EC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x00000274815B47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x0000027482D9E910>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x0000027482DCFBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:45:13.387 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002D26BF0C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002D26C2D47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000002D26DAEBBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002D268164860>
    └ <WorkerThread(AnyIO worker thread, started 12764)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002D26D9DC4A0>
    └ <WorkerThread(AnyIO worker thread, started 12764)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000002D26D932660>, db=<sqlalchemy.orm.session.Session object at 0x000002D26D98B1...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002D26D98B2C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000002D26D98B110>
           │             └ <function remove_user at 0x000002D26D5BEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x000002D26D98B110>
    │           └ <function commit at 0x000002D26D5BEA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x000002D26C1D99E0>
           └ <sqlalchemy.orm.session.Session object at 0x000002D26D98B110>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000002D26C1D8AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002D26DA710E0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002D26DA710E0>
                └ <function SessionTransaction.commit at 0x000002D26C1D8900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000002D26C1D87C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002D26DA710E0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002D26DA710E0>
                └ <function SessionTransaction._prepare_impl at 0x000002D26C1D8720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000002D26C1E4900>
    │    └ <sqlalchemy.orm.session.Session object at 0x000002D26D98B110>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000002D26DA710E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000002D26C1E4AE0>
    └ <sqlalchemy.orm.session.Session object at 0x000002D26D98B110>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000002D26DB2F300>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000002D26C1C93A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000002D26DACFC90>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000002D26DACFC90>
    │   └ <function SaveUpdateAll.execute at 0x000002D26C1C9EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000002D26C175A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x000002D26C1C00E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x000002D26BE48360>
        └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x000002D26DB2E810>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000002D26BE48680>
           └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000002D26BE48860>
          └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000002D26BE48900>
           └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000002D26BE48B80>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000002D26BF0C360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000002D26C2D47D0>
    └ <sqlalchemy.engine.base.Connection object at 0x000002D26DABE610>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000002D26DAEBBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:45:22.681 | ERROR    | app.crud.user_crud:get_authenticated_user:64 - Exception with username=First55Select, email=firstUser55@gmail.com: Could not determine join condition between parent/child tables on relationship User.sessions - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2423, in _determine_joins
    self.primaryjoin = join_condition(
    │                  └ <function join_condition at 0x0000015939BE2480>
    └ <sqlalchemy.orm.relationships.JoinCondition object at 0x000001593BA3B650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\util.py", line 123, in join_condition
    return Join._join_condition(
           │    └ <classmethod(<function Join._join_condition at 0x0000015939DAC9A0>)>
           └ <class 'sqlalchemy.sql.selectable.Join'>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1380, in _join_condition
    raise exc.NoForeignKeysError(
          │   └ <class 'sqlalchemy.exc.NoForeignKeysError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'user' and 'user_session'.


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000159361E4860>
    └ <WorkerThread(AnyIO worker thread, started 31204)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001593BA2C400>
    └ <WorkerThread(AnyIO worker thread, started 31204)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001593B9825C0>, db=<sqlalchemy.orm.session.Session object at 0x000001593B9DB3...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001593B986700>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
           │             └ <function remove_user at 0x000001593B60EB60>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 128, in remove_user
    db_user = user_crud.get_authenticated_user(db=db, username=username, email=data.email, password_hash=data.password)
              │         │                         │            │               │    │                    │    └ 'Password1234$'
              │         │                         │            │               │    │                    └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            │               │    └ 'firstUser55@gmail.com'
              │         │                         │            │               └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            └ 'First55Select'
              │         │                         └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
              │         └ <function get_authenticated_user at 0x000001593B60E5C0>
              └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 53, in get_authenticated_user
    query = db.query(models.User)
            │  │     │      └ <class 'app.models.database.User'>
            │  │     └ <module 'app.models.database' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\models\\datab...
            │  └ <function Session.query at 0x000001593A22B2E0>
            └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2952, in query
    return self._query_cls(entities, self, **kwargs)
           │    │          │         │       └ {}
           │    │          │         └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
           │    │          └ (<class 'app.models.database.User'>,)
           │    └ <class 'sqlalchemy.orm.query.Query'>
           └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 275, in __init__
    self._set_entities(entities)
    │    │             └ (<class 'app.models.database.User'>,)
    │    └ <function Query._set_entities at 0x000001593A164F40>
    └ <sqlalchemy.orm.query.Query object at 0x000001593B9970D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 287, in _set_entities
    self._raw_columns = [
    └ <sqlalchemy.orm.query.Query object at 0x000001593B9970D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 288, in <listcomp>
    coercions.expect(
    │         └ <function expect at 0x0000015939BAC220>
    └ <module 'sqlalchemy.sql.coercions' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\s...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
    │    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1253, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
    │   │        │    │                    │    │    └ <Mapper at 0x159398b7910; User>
    │   │        │    │                    │    └ <function Mapper._post_inspect at 0x000001593A1611C0>
    │   │        │    │                    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    │   │        │    └ '_post_inspect'
    │   │        └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    │   └ <attribute '__dict__' of 'Mapper' objects>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2711, in _post_inspect
    self._check_configure()
    │    └ <function Mapper._check_configure at 0x000001593A160400>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2388, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x000001593A4C13D0>
    │                      └ <Mapper at 0x159398b7910; User>
    └ <function _configure_registries at 0x000001593A1640E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4204, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x000001593A164220>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4245, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x000001593A1602C0>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2405, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x000001593A020C20>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 584, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x000001593A132B60>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1644, in do_init
    self._setup_join_conditions()
    │    └ <function RelationshipProperty._setup_join_conditions at 0x000001593A132DE0>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1884, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
    │                           └ <class 'sqlalchemy.orm.relationships.JoinCondition'>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2310, in __init__
    self._determine_joins()
    │    └ <function JoinCondition._determine_joins at 0x000001593A133E20>
    └ <sqlalchemy.orm.relationships.JoinCondition object at 0x000001593BA3B650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2444, in _determine_joins
    raise sa_exc.NoForeignKeysError(
          │      └ <class 'sqlalchemy.exc.NoForeignKeysError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship User.sessions - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.
2024-11-07 00:45:22.770 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2423, in _determine_joins
    self.primaryjoin = join_condition(
    │                  └ <function join_condition at 0x0000015939BE2480>
    └ <sqlalchemy.orm.relationships.JoinCondition object at 0x000001593BA3B650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\util.py", line 123, in join_condition
    return Join._join_condition(
           │    └ <classmethod(<function Join._join_condition at 0x0000015939DAC9A0>)>
           └ <class 'sqlalchemy.sql.selectable.Join'>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\selectable.py", line 1380, in _join_condition
    raise exc.NoForeignKeysError(
          │   └ <class 'sqlalchemy.exc.NoForeignKeysError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.NoForeignKeysError: Can't find any foreign key relationships between 'user' and 'user_session'.


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 53, in get_authenticated_user
    query = db.query(models.User)
            │  │     │      └ <class 'app.models.database.User'>
            │  │     └ <module 'app.models.database' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\models\\datab...
            │  └ <function Session.query at 0x000001593A22B2E0>
            └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2952, in query
    return self._query_cls(entities, self, **kwargs)
           │    │          │         │       └ {}
           │    │          │         └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
           │    │          └ (<class 'app.models.database.User'>,)
           │    └ <class 'sqlalchemy.orm.query.Query'>
           └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 275, in __init__
    self._set_entities(entities)
    │    │             └ (<class 'app.models.database.User'>,)
    │    └ <function Query._set_entities at 0x000001593A164F40>
    └ <sqlalchemy.orm.query.Query object at 0x000001593B9970D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 287, in _set_entities
    self._raw_columns = [
    └ <sqlalchemy.orm.query.Query object at 0x000001593B9970D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 288, in <listcomp>
    coercions.expect(
    │         └ <function expect at 0x0000015939BAC220>
    └ <module 'sqlalchemy.sql.coercions' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\s...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
    │    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1253, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
    │   │        │    │                    │    │    └ <Mapper at 0x159398b7910; User>
    │   │        │    │                    │    └ <function Mapper._post_inspect at 0x000001593A1611C0>
    │   │        │    │                    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    │   │        │    └ '_post_inspect'
    │   │        └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x000001593A15D510>
    │   └ <attribute '__dict__' of 'Mapper' objects>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2711, in _post_inspect
    self._check_configure()
    │    └ <function Mapper._check_configure at 0x000001593A160400>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2388, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x000001593A4C13D0>
    │                      └ <Mapper at 0x159398b7910; User>
    └ <function _configure_registries at 0x000001593A1640E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4204, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x000001593A164220>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4245, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x000001593A1602C0>
    └ <Mapper at 0x159398b7910; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2405, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x000001593A020C20>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 584, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x000001593A132B60>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1644, in do_init
    self._setup_join_conditions()
    │    └ <function RelationshipProperty._setup_join_conditions at 0x000001593A132DE0>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1884, in _setup_join_conditions
    self._join_condition = jc = JoinCondition(
    │                           └ <class 'sqlalchemy.orm.relationships.JoinCondition'>
    └ <_RelationshipDeclared at 0x1593a4f5270; sessions>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2310, in __init__
    self._determine_joins()
    │    └ <function JoinCondition._determine_joins at 0x000001593A133E20>
    └ <sqlalchemy.orm.relationships.JoinCondition object at 0x000001593BA3B650>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 2444, in _determine_joins
    raise sa_exc.NoForeignKeysError(
          │      └ <class 'sqlalchemy.exc.NoForeignKeysError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.NoForeignKeysError: Could not determine join condition between parent/child tables on relationship User.sessions - there are no foreign keys linking these tables.  Ensure that referencing columns are associated with a ForeignKey or ForeignKeyConstraint, or specify a 'primaryjoin' expression.


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000159361E4860>
    └ <WorkerThread(AnyIO worker thread, started 31204)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001593BA2C400>
    └ <WorkerThread(AnyIO worker thread, started 31204)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001593B9825C0>, db=<sqlalchemy.orm.session.Session object at 0x000001593B9DB3...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001593B986700>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
           │             └ <function remove_user at 0x000001593B60EB60>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 128, in remove_user
    db_user = user_crud.get_authenticated_user(db=db, username=username, email=data.email, password_hash=data.password)
              │         │                         │            │               │    │                    │    └ 'Password1234$'
              │         │                         │            │               │    │                    └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            │               │    └ 'firstUser55@gmail.com'
              │         │                         │            │               └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            └ 'First55Select'
              │         │                         └ <sqlalchemy.orm.session.Session object at 0x000001593B9DB310>
              │         └ <function get_authenticated_user at 0x000001593B60E5C0>
              └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 65, in get_authenticated_user
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 00:46:13.299 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001F5368AC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001F536C74850>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001F53848FBC0; closed: -1>

psycopg2.errors.NotNullViolation: null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).



The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001F532AE4860>
    └ <WorkerThread(AnyIO worker thread, started 16656)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001F5383784A0>
    └ <WorkerThread(AnyIO worker thread, started 16656)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001F5382D2660>, db=<sqlalchemy.orm.session.Session object at 0x000001F53830B8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001F5383275C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001F53830B890>
           │             └ <function remove_user at 0x000001F537F5EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 138, in remove_user
    shared_crud.commit(db)
    │           │      └ <sqlalchemy.orm.session.Session object at 0x000001F53830B890>
    │           └ <function commit at 0x000001F537F5EA20>
    └ <module 'app.crud.shared_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\shared...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\shared_crud.py", line 7, in commit
    return db.commit()
           │  └ <function Session.commit at 0x000001F536B799E0>
           └ <sqlalchemy.orm.session.Session object at 0x000001F53830B890>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2028, in commit
    trans.commit(_to_root=True)
    │     └ <function SessionTransaction.commit at 0x000001F536B78AE0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F5382F10E0>
  File "<string>", line 2, in commit
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {'_to_root': True}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F5382F10E0>
                └ <function SessionTransaction.commit at 0x000001F536B78900>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1313, in commit
    self._prepare_impl()
    │    └ <function SessionTransaction._prepare_impl at 0x000001F536B787C0>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F5382F10E0>
  File "<string>", line 2, in _prepare_impl
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py", line 139, in _go
    ret_value = fn(self, *arg, **kw)
                │  │      │      └ {}
                │  │      └ ()
                │  └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F5382F10E0>
                └ <function SessionTransaction._prepare_impl at 0x000001F536B78720>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 1288, in _prepare_impl
    self.session.flush()
    │    │       └ <function Session.flush at 0x000001F536B84900>
    │    └ <sqlalchemy.orm.session.Session object at 0x000001F53830B890>
    └ <sqlalchemy.orm.session.SessionTransaction object at 0x000001F5382F10E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4352, in flush
    self._flush(objects)
    │    │      └ None
    │    └ <function Session._flush at 0x000001F536B84AE0>
    └ <sqlalchemy.orm.session.Session object at 0x000001F53830B890>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4487, in _flush
    with util.safe_reraise():
         │    └ <class 'sqlalchemy.util.langhelpers.safe_reraise'>
         └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
          │         │              └ <traceback object at 0x000001F5384D3400>
          │         └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 4448, in _flush
    flush_context.execute()
    │             └ <function UOWTransaction.execute at 0x000001F536B693A0>
    └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001F53846F7D0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 466, in execute
    rec.execute(self)
    │   │       └ <sqlalchemy.orm.unitofwork.UOWTransaction object at 0x000001F53846F7D0>
    │   └ <function SaveUpdateAll.execute at 0x000001F536B69EE0>
    └ SaveUpdateAll(Mapper[UserSession(user_session)])
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    │    │         │               └ <function save_obj at 0x000001F536B15A80>
    │    │         └ <module 'sqlalchemy.orm.persistence' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\...
    │    └ <module 'sqlalchemy.util.preloaded' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\...
    └ <module 'sqlalchemy.util' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 85, in save_obj
    _emit_update_statements(
    └ <function _emit_update_statements at 0x000001F536B600E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        │          └ <function Connection.execute at 0x000001F5367E8360>
        └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1418, in execute
    return meth(
           └ <bound method ClauseElement._execute_on_connection of <sqlalchemy.sql.dml.Update object at 0x000001F5384D2A10>>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\elements.py", line 515, in _execute_on_connection
    return connection._execute_clauseelement(
           │          └ <function Connection._execute_clauseelement at 0x000001F5367E8680>
           └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1640, in _execute_clauseelement
    ret = self._execute_context(
          │    └ <function Connection._execute_context at 0x000001F5367E8860>
          └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1846, in _execute_context
    return self._exec_single_context(
           │    └ <function Connection._exec_single_context at 0x000001F5367E8900>
           └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    │    └ <function Connection._handle_dbapi_exception at 0x000001F5367E8B80>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 2355, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
          │                    │              │                 └ NotNullViolation('null value in column "fk_user_id" of relation "user_session" violates not-null constraint\nDETAIL:  Failing...
          │                    │              └ (<class 'psycopg2.errors.NotNullViolation'>, NotNullViolation('null value in column "fk_user_id" of relation "user_session" v...
          │                    └ <method 'with_traceback' of 'BaseException' objects>
          └ IntegrityError('(psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    │    │       └ <function DefaultDialect.do_execute at 0x000001F5368AC360>
    │    └ <sqlalchemy.dialects.postgresql.psycopg2.PGDialect_psycopg2 object at 0x000001F536C74850>
    └ <sqlalchemy.engine.base.Connection object at 0x000001F53845EE50>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py", line 941, in do_execute
    cursor.execute(statement, parameters)
    │      │       │          └ {'fk_user_id': None, 'user_session_session_id': 15}
    │      │       └ 'UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s'
    │      └ <method 'execute' of 'psycopg2.extensions.cursor' objects>
    └ <cursor object at 0x000001F53848FBC0; closed: -1>

sqlalchemy.exc.IntegrityError: (psycopg2.errors.NotNullViolation) null value in column "fk_user_id" of relation "user_session" violates not-null constraint
DETAIL:  Failing row contains (15, 2024-11-06 13:16:04.68704+02, 127.0.0.1, null).

[SQL: UPDATE user_session SET fk_user_id=%(fk_user_id)s WHERE user_session.session_id = %(user_session_session_id)s]
[parameters: {'fk_user_id': None, 'user_session_session_id': 15}]
(Background on this error at: https://sqlalche.me/e/20/gkpj)
2024-11-07 00:46:47.354 | ERROR    | app.crud.user_crud:get_authenticated_user:64 - Exception with username=First55Select, email=firstUser55@gmail.com: For many-to-one relationship UserSession.user, delete-orphan cascade is normally configured only on the "one" side of a one-to-many relationship, and not on the "many" side of a many-to-one or many-to-many relationship.  To force this relationship to allow a particular "User" object to be referenced by only a single "UserSession" object at a time via the UserSession.user relationship, which would allow delete-orphan cascade to take place in this direction, set the single_parent=True flag. (Background on this error at: https://sqlalche.me/e/20/bbf0)
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027815BB4860>
    └ <WorkerThread(AnyIO worker thread, started 20464)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002781B4384A0>
    └ <WorkerThread(AnyIO worker thread, started 20464)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000002781B392660>, db=<sqlalchemy.orm.session.Session object at 0x000002781B3CB8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002781B446E80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
           │             └ <function remove_user at 0x000002781B01EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 128, in remove_user
    db_user = user_crud.get_authenticated_user(db=db, username=username, email=data.email, password_hash=data.password)
              │         │                         │            │               │    │                    │    └ 'Password1234$'
              │         │                         │            │               │    │                    └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            │               │    └ 'firstUser55@gmail.com'
              │         │                         │            │               └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            └ 'First55Select'
              │         │                         └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
              │         └ <function get_authenticated_user at 0x000002781B01E660>
              └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 53, in get_authenticated_user
    query = db.query(models.User)
            │  │     │      └ <class 'app.models.database.User'>
            │  │     └ <module 'app.models.database' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\models\\datab...
            │  └ <function Session.query at 0x0000027819C3B2E0>
            └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2952, in query
    return self._query_cls(entities, self, **kwargs)
           │    │          │         │       └ {}
           │    │          │         └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
           │    │          └ (<class 'app.models.database.User'>,)
           │    └ <class 'sqlalchemy.orm.query.Query'>
           └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 275, in __init__
    self._set_entities(entities)
    │    │             └ (<class 'app.models.database.User'>,)
    │    └ <function Query._set_entities at 0x0000027819B74F40>
    └ <sqlalchemy.orm.query.Query object at 0x000002781B3E7BD0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 287, in _set_entities
    self._raw_columns = [
    └ <sqlalchemy.orm.query.Query object at 0x000002781B3E7BD0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 288, in <listcomp>
    coercions.expect(
    │         └ <function expect at 0x00000278195BC220>
    └ <module 'sqlalchemy.sql.coercions' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\s...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
    │    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1253, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
    │   │        │    │                    │    │    └ <Mapper at 0x27819f21590; User>
    │   │        │    │                    │    └ <function Mapper._post_inspect at 0x0000027819B711C0>
    │   │        │    │                    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    │   │        │    └ '_post_inspect'
    │   │        └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    │   └ <attribute '__dict__' of 'Mapper' objects>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2711, in _post_inspect
    self._check_configure()
    │    └ <function Mapper._check_configure at 0x0000027819B70400>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2388, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x0000027819E84F10>
    │                      └ <Mapper at 0x27819f21590; User>
    └ <function _configure_registries at 0x0000027819B740E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4204, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x0000027819B74220>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4245, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x0000027819B702C0>
    └ <Mapper at 0x27819f4cf50; UserSession>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2405, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x0000027819A30C20>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 584, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x0000027819B42B60>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1645, in do_init
    self._check_cascade_settings(self._cascade)
    │    │                       │    └ CascadeOptions('delete,delete-orphan,expunge,merge,refresh-expire,save-update')
    │    │                       └ <_RelationshipDeclared at 0x27819f42490; user>
    │    └ <function RelationshipProperty._check_cascade_settings at 0x0000027819B43380>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1988, in _check_cascade_settings
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.ArgumentError: For many-to-one relationship UserSession.user, delete-orphan cascade is normally configured only on the "one" side of a one-to-many relationship, and not on the "many" side of a many-to-one or many-to-many relationship.  To force this relationship to allow a particular "User" object to be referenced by only a single "UserSession" object at a time via the UserSession.user relationship, which would allow delete-orphan cascade to take place in this direction, set the single_parent=True flag. (Background on this error at: https://sqlalche.me/e/20/bbf0)
2024-11-07 00:46:47.371 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 53, in get_authenticated_user
    query = db.query(models.User)
            │  │     │      └ <class 'app.models.database.User'>
            │  │     └ <module 'app.models.database' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\models\\datab...
            │  └ <function Session.query at 0x0000027819C3B2E0>
            └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py", line 2952, in query
    return self._query_cls(entities, self, **kwargs)
           │    │          │         │       └ {}
           │    │          │         └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
           │    │          └ (<class 'app.models.database.User'>,)
           │    └ <class 'sqlalchemy.orm.query.Query'>
           └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 275, in __init__
    self._set_entities(entities)
    │    │             └ (<class 'app.models.database.User'>,)
    │    └ <function Query._set_entities at 0x0000027819B74F40>
    └ <sqlalchemy.orm.query.Query object at 0x000002781B3E7BD0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 287, in _set_entities
    self._raw_columns = [
    └ <sqlalchemy.orm.query.Query object at 0x000002781B3E7BD0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\query.py", line 288, in <listcomp>
    coercions.expect(
    │         └ <function expect at 0x00000278195BC220>
    └ <module 'sqlalchemy.sql.coercions' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\s...
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\sql\coercions.py", line 389, in expect
    insp._post_inspect
    │    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 1253, in __get__
    obj.__dict__[self.__name__] = result = self.fget(obj)
    │   │        │    │                    │    │    └ <Mapper at 0x27819f21590; User>
    │   │        │    │                    │    └ <function Mapper._post_inspect at 0x0000027819B711C0>
    │   │        │    │                    └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    │   │        │    └ '_post_inspect'
    │   │        └ <sqlalchemy.util.langhelpers.HasMemoized.memoized_attribute object at 0x0000027819B6D550>
    │   └ <attribute '__dict__' of 'Mapper' objects>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2711, in _post_inspect
    self._check_configure()
    │    └ <function Mapper._check_configure at 0x0000027819B70400>
    └ <Mapper at 0x27819f21590; User>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2388, in _check_configure
    _configure_registries({self.registry}, cascade=True)
    │                      │    └ <sqlalchemy.orm.decl_api.registry object at 0x0000027819E84F10>
    │                      └ <Mapper at 0x27819f21590; User>
    └ <function _configure_registries at 0x0000027819B740E0>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4204, in _configure_registries
    _do_configure_registries(registries, cascade)
    │                        │           └ True
    │                        └ set()
    └ <function _do_configure_registries at 0x0000027819B74220>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 4245, in _do_configure_registries
    mapper._post_configure_properties()
    │      └ <function Mapper._post_configure_properties at 0x0000027819B702C0>
    └ <Mapper at 0x27819f4cf50; UserSession>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\mapper.py", line 2405, in _post_configure_properties
    prop.init()
    │    └ <function MapperProperty.init at 0x0000027819A30C20>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\interfaces.py", line 584, in init
    self.do_init()
    │    └ <function RelationshipProperty.do_init at 0x0000027819B42B60>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1645, in do_init
    self._check_cascade_settings(self._cascade)
    │    │                       │    └ CascadeOptions('delete,delete-orphan,expunge,merge,refresh-expire,save-update')
    │    │                       └ <_RelationshipDeclared at 0x27819f42490; user>
    │    └ <function RelationshipProperty._check_cascade_settings at 0x0000027819B43380>
    └ <_RelationshipDeclared at 0x27819f42490; user>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\relationships.py", line 1988, in _check_cascade_settings
    raise sa_exc.ArgumentError(
          │      └ <class 'sqlalchemy.exc.ArgumentError'>
          └ <module 'sqlalchemy.exc' from 'C:\\Users\\tomas\\AppData\\Local\\Programs\\Python\\Python311\\Lib\\site-packages\\sqlalchemy\...

sqlalchemy.exc.ArgumentError: For many-to-one relationship UserSession.user, delete-orphan cascade is normally configured only on the "one" side of a one-to-many relationship, and not on the "many" side of a many-to-one or many-to-many relationship.  To force this relationship to allow a particular "User" object to be referenced by only a single "UserSession" object at a time via the UserSession.user relationship, which would allow delete-orphan cascade to take place in this direction, set the single_parent=True flag. (Background on this error at: https://sqlalche.me/e/20/bbf0)


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027815BB4860>
    └ <WorkerThread(AnyIO worker thread, started 20464)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002781B4384A0>
    └ <WorkerThread(AnyIO worker thread, started 20464)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000002781B392660>, db=<sqlalchemy.orm.session.Session object at 0x000002781B3CB8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002781B446E80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
           │             │              │            └ 'First55Select'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
           │             └ <function remove_user at 0x000002781B01EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 128, in remove_user
    db_user = user_crud.get_authenticated_user(db=db, username=username, email=data.email, password_hash=data.password)
              │         │                         │            │               │    │                    │    └ 'Password1234$'
              │         │                         │            │               │    │                    └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            │               │    └ 'firstUser55@gmail.com'
              │         │                         │            │               └ UserDelete(email='firstUser55@gmail.com', password='Password1234$')
              │         │                         │            └ 'First55Select'
              │         │                         └ <sqlalchemy.orm.session.Session object at 0x000002781B3CB890>
              │         └ <function get_authenticated_user at 0x000002781B01E660>
              └ <module 'app.crud.user_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\user_cru...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\user_crud.py", line 65, in get_authenticated_user
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 00:49:37.281 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EEC8984860>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001EECE1DC4A0>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001EECE132660>, db=<sqlalchemy.orm.session.Session object at 0x000001EECE187D...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001EECE137D40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser56@gmail.com', password='Password1234s$')
           │             │              │            └ 'First56'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001EECE187D90>
           │             └ <function remove_user at 0x000001EECDDBEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 134, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 00:49:46.174 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: Invalid email format
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EEC8984860>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001EECE1DC4A0>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001EECE132660>, db=<sqlalchemy.orm.session.Session object at 0x000001EECE1799...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001EECE187C80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser56@gmail.com,', password='Password1234$')
           │             │              │            └ 'First56'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001EECE179950>
           │             └ <function remove_user at 0x000001EECDDBEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 124, in remove_user
    user_validator.validate_email(data.email)
    │              │              │    └ 'firstUser56@gmail.com,'
    │              │              └ UserDelete(email='firstUser56@gmail.com,', password='Password1234$')
    │              └ <function validate_email at 0x000001EECDDBE160>
    └ <module 'app.validators.user_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\val...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\user_validator.py", line 52, in validate_email
    raise shared_validator.ValidationException("Invalid email format")
          │                └ <class 'app.validators.shared_validator.ValidationException'>
          └ <module 'app.validators.shared_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\v...

app.validators.shared_validator.ValidationException: Invalid email format
2024-11-07 00:49:50.696 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EEC8984860>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001EECE1DC4A0>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001EECE132660>, db=<sqlalchemy.orm.session.Session object at 0x000001EECE33E0...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001EECE339280>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser56@gmail.comm', password='Password1234$')
           │             │              │            └ 'First56'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001EECE33E010>
           │             └ <function remove_user at 0x000001EECDDBEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 134, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 00:49:54.853 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EEC8984860>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001EECE1DC4A0>
    └ <WorkerThread(AnyIO worker thread, started 19132)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001EECE132660>, db=<sqlalchemy.orm.session.Session object at 0x000001EECE2BE7...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001EECE3450C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser56@gmail.com', password='Password1234$')
           │             │              │            └ 'First56s'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000001EECE2BE7D0>
           │             └ <function remove_user at 0x000001EECDDBEC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 134, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 16:48:34.589 | ERROR    | app.services.user_service:get_user_account_data:65 - USER: First33k DATA CANNOT BE PARSED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000020708FC4860>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002070E7FC4A0>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function read_user at 0x000002070E752160>, db=<sqlalchemy.orm.session.Session object at 0x000002070E806350...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002070E7AB380>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 45, in read_user
    return user_services.get_user_account_data(db=db, username=username)
           │             │                        │            └ 'First33k'
           │             │                        └ <sqlalchemy.orm.session.Session object at 0x000002070E806350>
           │             └ <function get_user_account_data at 0x000002070D40E480>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 60, in get_user_account_data
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 16:49:33.389 | ERROR    | app.services.user_service:create_user:46 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Username or email already in use
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000020708FC4860>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002070E7FC4A0>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x000002070E751C60>, db=<sqlalchemy.orm.session.Session object at 0x000002070D4205...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002070E7AA7C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_services.create_user(db=db, request=request, user=user)
           │             │              │           │             └ UserCreate(username='First56', email='firstUser56@gmail.com', password='Password1234$', role=None)
           │             │              │           └ <starlette.requests.Request object at 0x000002070E955410>
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000002070D420550>
           │             └ <function create_user at 0x000002070D40D6C0>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 30, in create_user
    raise HTTPException(status_code=409, detail="Username or email already in use")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Username or email already in use
2024-11-07 16:56:23.660 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000020708FC4860>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002070E7FC4A0>
    └ <WorkerThread(AnyIO worker thread, started 28380)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000002070E752660>, db=<sqlalchemy.orm.session.Session object at 0x000002070E79C6...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002070E79D380>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_services.remove_user(db=db, username=username, data=data)
           │             │              │            │              └ UserDelete(email='firstUser56@gmail.comc', password='Password1234$')
           │             │              │            └ 'First56'
           │             │              └ <sqlalchemy.orm.session.Session object at 0x000002070E79C610>
           │             └ <function remove_user at 0x000002070D40EC00>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 134, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 17:13:42.588 | ERROR    | app.services.user_service:create_user:46 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Username or email already in use
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027A11544860>
    └ <WorkerThread(AnyIO worker thread, started 8124)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000027A16DCC540>
    └ <WorkerThread(AnyIO worker thread, started 8124)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x0000027A16D25DA0>, db=<sqlalchemy.orm.session.Session object at 0x0000027A114A4F...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000027A16D63D40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_service.create_user(db=db, request=request, user=user)
           │            │              │           │             └ UserCreate(username='First56', email='firstUser56@gmail.com', password='Password1234$', role=None)
           │            │              │           └ <starlette.requests.Request object at 0x0000027A16D7A650>
           │            │              └ <sqlalchemy.orm.session.Session object at 0x0000027A114A4F10>
           │            └ <function create_user at 0x0000027A158947C0>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 30, in create_user
    raise HTTPException(status_code=409, detail="Username or email already in use")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Username or email already in use
2024-11-07 17:14:01.846 | ERROR    | app.services.user_service:remove_user:142 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027A11544860>
    └ <WorkerThread(AnyIO worker thread, started 8124)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000027A16DCC540>
    └ <WorkerThread(AnyIO worker thread, started 8124)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x0000027A16D267A0>, db=<sqlalchemy.orm.session.Session object at 0x0000027A16ED6A...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000027A16D3F5C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_service.remove_user(db=db, username=username, data=data)
           │            │              │            │              └ UserDelete(email='firstUser56@gmail.comc', password='Password1234$')
           │            │              │            └ 'First56'
           │            │              └ <sqlalchemy.orm.session.Session object at 0x0000027A16ED6A10>
           │            └ <function remove_user at 0x0000027A159DA340>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 134, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 17:27:17.760 | ERROR    | app.services.user_service:create_user:46 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: Username must be between 4 and 50 characters long
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027FBB5F4860>
    └ <WorkerThread(AnyIO worker thread, started 16048)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000027FC0E9C540>
    └ <WorkerThread(AnyIO worker thread, started 16048)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x0000027FC0DF5DA0>, db=<sqlalchemy.orm.session.Session object at 0x0000027FC0E1B5...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000027FC0E236C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_service.create_user(db=db, request=request, user=user)
           │            │              │           │             └ UserCreate(username='First566666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666...
           │            │              │           └ <starlette.requests.Request object at 0x0000027FC0E4AC50>
           │            │              └ <sqlalchemy.orm.session.Session object at 0x0000027FC0E1B590>
           │            └ <function create_user at 0x0000027FBF9647C0>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 14, in create_user
    user_validator.validate_username(user.username)
    │              │                 │    └ 'First56666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666...
    │              │                 └ UserCreate(username='First566666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666...
    │              └ <function validate_username at 0x0000027FC09BC5E0>
    └ <module 'app.validators.user_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\val...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\user_validator.py", line 26, in validate_username
    raise shared_validator.ValidationException(f"Username must be between {MIN_USERNAME_LENGTH} and {MAX_USERNAME_LENGTH} characters long")
          │                └ <class 'app.validators.shared_validator.ValidationException'>
          └ <module 'app.validators.shared_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\v...

app.validators.shared_validator.ValidationException: Username must be between 4 and 50 characters long
2024-11-07 17:28:12.154 | ERROR    | app.services.user_service:create_user:46 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: Email must be between 5 and 100 characters long
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000027FBB5F4860>
    └ <WorkerThread(AnyIO worker thread, started 16048)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000027FC0E9C540>
    └ <WorkerThread(AnyIO worker thread, started 16048)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x0000027FC0DF5DA0>, db=<sqlalchemy.orm.session.Session object at 0x0000027FC09DD6...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000027FC0E0EE00>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_service.create_user(db=db, request=request, user=user)
           │            │              │           │             └ UserCreate(username='First56', email='firstUser566666666666666666666666666666666666666666666666666666666666666666666666666666...
           │            │              │           └ <starlette.requests.Request object at 0x0000027FC0F23D90>
           │            │              └ <sqlalchemy.orm.session.Session object at 0x0000027FC09DD650>
           │            └ <function create_user at 0x0000027FBF9647C0>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 15, in create_user
    user_validator.validate_email(user.email)
    │              │              │    └ 'firstUser5666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666...
    │              │              └ UserCreate(username='First56', email='firstUser566666666666666666666666666666666666666666666666666666666666666666666666666666...
    │              └ <function validate_email at 0x0000027FC09BC7C0>
    └ <module 'app.validators.user_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\val...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\user_validator.py", line 47, in validate_email
    raise shared_validator.ValidationException(f"Email must be between {MIN_EMAIL_LENGTH} and {MAX_EMAIL_LENGTH} characters long")
          │                └ <class 'app.validators.shared_validator.ValidationException'>
          └ <module 'app.validators.shared_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\v...

app.validators.shared_validator.ValidationException: Email must be between 5 and 100 characters long
2024-11-07 20:13:18.499 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: module 'app.config.logger' has no attribute 'info'
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001FBD7E04860>
    └ <WorkerThread(AnyIO worker thread, started 28500)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001FBDD65C9A0>
    └ <WorkerThread(AnyIO worker thread, started 28500)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001FBDD5B2E80>, db=<sqlalchemy.orm.session.Session object at 0x000001FBDD...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001FBDD5EFB40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija7', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001FBDD5BEE90>
           │                └ <function create_category at 0x000001FBDC26A480>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 13, in create_category
    category_validator.validate_category_name(category_name=category.name)
    │                  │                                    │        └ 'Kategorija7'
    │                  │                                    └ CategoryCreate(name='Kategorija7', description='Kategorijos aprasymas.')
    │                  └ <function validate_category_name at 0x000001FBDC26A8E0>
    └ <module 'app.validators.category_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\category_validator.py", line 12, in validate_category_name
    logger.info(f"Validating category name")
    └ <module 'app.config.logger' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\config\\logger....

AttributeError: module 'app.config.logger' has no attribute 'info'
2024-11-07 20:17:12.466 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023DD2914860>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000023DD819C9A0>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x0000023DD80F2E80>, db=<sqlalchemy.orm.session.Session object at 0x0000023DD8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000023DD8141D40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija7', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x0000023DD811B890>
           │                └ <function create_category at 0x0000023DD6DAA520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 20:28:16.144 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023DD2914860>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000023DD819C9A0>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x0000023DD80F2E80>, db=<sqlalchemy.orm.session.Session object at 0x0000023DD8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000023DD814B1C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija7', description='Kategorijos aprasymass.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x0000023DD8286090>
           │                └ <function create_category at 0x0000023DD6DAA520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 20:28:25.119 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023DD2914860>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000023DD819C9A0>
    └ <WorkerThread(AnyIO worker thread, started 30908)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x0000023DD80F2E80>, db=<sqlalchemy.orm.session.Session object at 0x0000023DD8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000023DD8303640>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija7', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x0000023DD81A6890>
           │                └ <function create_category at 0x0000023DD6DAA520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 20:54:50.252 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001E306474860>
    └ <WorkerThread(AnyIO worker thread, started 17696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001E30BC9C9A0>
    └ <WorkerThread(AnyIO worker thread, started 17696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001E30BBF2E80>, db=<sqlalchemy.orm.session.Session object at 0x000001E30B...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001E30BC2FA40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija8', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001E30BC4B890>
           │                └ <function create_category at 0x000001E30A8AA480>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 20:58:09.516 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001E306474860>
    └ <WorkerThread(AnyIO worker thread, started 17696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001E30BC9C9A0>
    └ <WorkerThread(AnyIO worker thread, started 17696)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001E30BBF2E80>, db=<sqlalchemy.orm.session.Session object at 0x000001E30B...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001E30BC033C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija9', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001E30BD05050>
           │                └ <function create_category at 0x000001E30A8AA480>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:00:17.762 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001A1E29D4860>
    └ <WorkerThread(AnyIO worker thread, started 29912)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001A1E825CA40>
    └ <WorkerThread(AnyIO worker thread, started 29912)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001A1E81B2F20>, db=<sqlalchemy.orm.session.Session object at 0x000001A1E8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001A1E81DBB80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija10', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001A1E8201D50>
           │                └ <function create_category at 0x000001A1E7E3A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:03:46.578 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001F55BE64860>
    └ <WorkerThread(AnyIO worker thread, started 21684)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001F5616CCA40>
    └ <WorkerThread(AnyIO worker thread, started 21684)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001F561622F20>, db=<sqlalchemy.orm.session.Session object at 0x000001F561...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001F56030EB80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija11', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001F561672150>
           │                └ <function create_category at 0x000001F5602DA520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:04:06.644 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001DC65334860>
    └ <WorkerThread(AnyIO worker thread, started 32324)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001DC6AAFCA40>
    └ <WorkerThread(AnyIO worker thread, started 32324)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001DC6AA52F20>, db=<sqlalchemy.orm.session.Session object at 0x000001DC6A...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001DC6AA81500>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija12', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001DC6AAABA10>
           │                └ <function create_category at 0x000001DC6970A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:05:43.787 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021077534860>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002107CD2CA40>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000002107CC82F20>, db=<sqlalchemy.orm.session.Session object at 0x000002107C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002107CCDAF00>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija14', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000002107CCABC90>
           │                └ <function create_category at 0x000002107B93A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:21:58.743 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021077534860>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002107CD2CA40>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000002107CC82F20>, db=<sqlalchemy.orm.session.Session object at 0x000002107C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002107CC9FC80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija15', description=None)
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000002107CE8BB10>
           │                └ <function create_category at 0x000002107B93A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 21:27:14.278 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: Category description must be less than 255 characters long
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021077534860>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002107CD2CA40>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000002107CC82F20>, db=<sqlalchemy.orm.session.Session object at 0x000002107C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002107CC9D0C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija18', description='1000000000000000000000000000000000000000000000000000000000000000000000000000...
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000002107CE86590>
           │                └ <function create_category at 0x000002107B93A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 16, in create_category
    category_validator.validate_category_description(description=category.description)
    │                  │                                         │        └ '1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000...
    │                  │                                         └ CategoryCreate(name='Kategorija18', description='1000000000000000000000000000000000000000000000000000000000000000000000000000...
    │                  └ <function validate_category_description at 0x000002107B93A980>
    └ <module 'app.validators.category_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\category_validator.py", line 38, in validate_category_description
    raise shared_validator.ValidationException(f"Category description must be less than {MAX_DESCRIPTION_LENGTH} characters long")
          │                └ <class 'app.validators.shared_validator.ValidationException'>
          └ <module 'app.validators.shared_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\v...

app.validators.shared_validator.ValidationException: Category description must be less than 255 characters long
2024-11-07 21:27:38.950 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: Category name must be between 4 and 50 characters long
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021077534860>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002107CD2CA40>
    └ <WorkerThread(AnyIO worker thread, started 33424)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000002107CC82F20>, db=<sqlalchemy.orm.session.Session object at 0x000002107C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002107CE86C40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 72, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija1999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999...
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000002107CE94F50>
           │                └ <function create_category at 0x000002107B93A520>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 13, in create_category
    category_validator.validate_category_name(category_name=category.name)
    │                  │                                    │        └ 'Kategorija199999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999...
    │                  │                                    └ CategoryCreate(name='Kategorija1999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999...
    │                  └ <function validate_category_name at 0x000002107B93A8E0>
    └ <module 'app.validators.category_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\validators\category_validator.py", line 21, in validate_category_name
    raise shared_validator.ValidationException(f"Category name must be between {MIN_CATEGORY_NAME_LENGTH} and {MAX_CATEGORY_NAME_LENGTH} characters long")
          │                └ <class 'app.validators.shared_validator.ValidationException'>
          └ <module 'app.validators.shared_validator' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\v...

app.validators.shared_validator.ValidationException: Category name must be between 4 and 50 characters long
2024-11-07 22:39:47.211 | ERROR    | app.crud.category_crud:get_all_categories:57 - Exception: 'Session' object has no attribute 'get_all_categories'
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001BE4B2C4860>
    └ <WorkerThread(AnyIO worker thread, started 30128)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001BE50AD0C20>
    └ <WorkerThread(AnyIO worker thread, started 30128)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000001BE50A234C0>, db=<sqlalchemy.orm.session.Session object at 0x000001BE50...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001BE50A6D180>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
           │                └ <function get_categories at 0x000001BE506AA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
                 │             └ <function get_all_categories at 0x000001BE506AA7A0>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 51, in get_all_categories
    categories = db.get_all_categories(db=db)
                 │                        └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
                 └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>

AttributeError: 'Session' object has no attribute 'get_all_categories'
2024-11-07 22:39:47.239 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 51, in get_all_categories
    categories = db.get_all_categories(db=db)
                 │                        └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
                 └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>

AttributeError: 'Session' object has no attribute 'get_all_categories'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001BE4B2C4860>
    └ <WorkerThread(AnyIO worker thread, started 30128)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001BE50AD0C20>
    └ <WorkerThread(AnyIO worker thread, started 30128)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000001BE50A234C0>, db=<sqlalchemy.orm.session.Session object at 0x000001BE50...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001BE50A6D180>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
           │                └ <function get_categories at 0x000001BE506AA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000001BE50A3F710>
                 │             └ <function get_all_categories at 0x000001BE506AA7A0>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 58, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 22:43:26.833 | ERROR    | app.crud.category_crud:get_all_categories:57 - Exception: 'Session' object has no attribute 'get_all_categories'
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023ED3594860>
    └ <WorkerThread(AnyIO worker thread, started 3032)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000023ED8E20C20>
    └ <WorkerThread(AnyIO worker thread, started 3032)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x0000023ED8D734C0>, db=<sqlalchemy.orm.session.Session object at 0x0000023ED8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000023ED8DCB940>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
           │                └ <function get_categories at 0x0000023ED7A2A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
                 │             └ <function get_all_categories at 0x0000023ED7A2A7A0>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 51, in get_all_categories
    categories = db.get_all_categories(db=db)
                 │                        └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
                 └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>

AttributeError: 'Session' object has no attribute 'get_all_categories'
2024-11-07 22:43:26.840 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 51, in get_all_categories
    categories = db.get_all_categories(db=db)
                 │                        └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
                 └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>

AttributeError: 'Session' object has no attribute 'get_all_categories'


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023ED3594860>
    └ <WorkerThread(AnyIO worker thread, started 3032)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x0000023ED8E20C20>
    └ <WorkerThread(AnyIO worker thread, started 3032)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x0000023ED8D734C0>, db=<sqlalchemy.orm.session.Session object at 0x0000023ED8...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x0000023ED8DCB940>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
           │                └ <function get_categories at 0x0000023ED7A2A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x0000023ED8DE10D0>
                 │             └ <function get_all_categories at 0x0000023ED7A2A7A0>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 58, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 22:52:29.561 | ERROR    | app.crud.category_crud:get_all_categories:58 - Exception: 'Category' object is not subscriptable
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001C569BB4860>
    └ <WorkerThread(AnyIO worker thread, started 32220)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001C56F450D60>
    └ <WorkerThread(AnyIO worker thread, started 32220)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000001C56F3A34C0>, db=<sqlalchemy.orm.session.Session object at 0x000001C56C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001C56F3FA0C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000001C56C53EF90>
           │                └ <function get_categories at 0x000001C56E05A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000001C56C53EF90>
                 │             └ <function get_all_categories at 0x000001C56E05A840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000001C56F5499D0>, <app.models.database.Category object at 0x000001C56F3CBE50>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000001C56F5499D0>
                       └ <app.models.database.Category object at 0x000001C56F5499D0>

TypeError: 'Category' object is not subscriptable
2024-11-07 22:52:29.571 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000001C56F5499D0>, <app.models.database.Category object at 0x000001C56F3CBE50>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000001C56F5499D0>
                       └ <app.models.database.Category object at 0x000001C56F5499D0>

TypeError: 'Category' object is not subscriptable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001C569BB4860>
    └ <WorkerThread(AnyIO worker thread, started 32220)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001C56F450D60>
    └ <WorkerThread(AnyIO worker thread, started 32220)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000001C56F3A34C0>, db=<sqlalchemy.orm.session.Session object at 0x000001C56C...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001C56F3FA0C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000001C56C53EF90>
           │                └ <function get_categories at 0x000001C56E05A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000001C56C53EF90>
                 │             └ <function get_all_categories at 0x000001C56E05A840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 59, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 22:52:51.387 | ERROR    | app.crud.category_crud:get_all_categories:58 - Exception: 'Category' object is not subscriptable
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002DE4BE44860>
    └ <WorkerThread(AnyIO worker thread, started 28440)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002DE51610D60>
    └ <WorkerThread(AnyIO worker thread, started 28440)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000002DE515634C0>, db=<sqlalchemy.orm.session.Session object at 0x000002DE4E...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002DE5157F300>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000002DE4E6FEF90>
           │                └ <function get_categories at 0x000002DE511EA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000002DE4E6FEF90>
                 │             └ <function get_all_categories at 0x000002DE511EA840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000002DE51709BD0>, <app.models.database.Category object at 0x000002DE51709C50>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000002DE51709BD0>
                       └ <app.models.database.Category object at 0x000002DE51709BD0>

TypeError: 'Category' object is not subscriptable
2024-11-07 22:52:51.395 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000002DE51709BD0>, <app.models.database.Category object at 0x000002DE51709C50>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000002DE51709BD0>
                       └ <app.models.database.Category object at 0x000002DE51709BD0>

TypeError: 'Category' object is not subscriptable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002DE4BE44860>
    └ <WorkerThread(AnyIO worker thread, started 28440)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002DE51610D60>
    └ <WorkerThread(AnyIO worker thread, started 28440)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000002DE515634C0>, db=<sqlalchemy.orm.session.Session object at 0x000002DE4E...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002DE5157F300>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000002DE4E6FEF90>
           │                └ <function get_categories at 0x000002DE511EA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000002DE4E6FEF90>
                 │             └ <function get_all_categories at 0x000002DE511EA840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 59, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 22:55:35.613 | ERROR    | app.crud.category_crud:get_all_categories:58 - Exception: 'Category' object is not subscriptable
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000192B4F34860>
    └ <WorkerThread(AnyIO worker thread, started 31928)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x00000192BA470C20>
    └ <WorkerThread(AnyIO worker thread, started 31928)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x00000192BA3C34C0>, db=<sqlalchemy.orm.session.Session object at 0x00000192BA...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x00000192BA3DFA00>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x00000192BA41BE90>
           │                └ <function get_categories at 0x00000192BA38A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x00000192BA41BE90>
                 │             └ <function get_all_categories at 0x00000192BA38A840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x00000192BA8A5190>, <app.models.database.Category object at 0x00000192BA3D1C10>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x00000192BA8A5190>
                       └ <app.models.database.Category object at 0x00000192BA8A5190>

TypeError: 'Category' object is not subscriptable
2024-11-07 22:55:35.621 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x00000192BA8A5190>, <app.models.database.Category object at 0x00000192BA3D1C10>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x00000192BA8A5190>
                       └ <app.models.database.Category object at 0x00000192BA8A5190>

TypeError: 'Category' object is not subscriptable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000192B4F34860>
    └ <WorkerThread(AnyIO worker thread, started 31928)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x00000192BA470C20>
    └ <WorkerThread(AnyIO worker thread, started 31928)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x00000192BA3C34C0>, db=<sqlalchemy.orm.session.Session object at 0x00000192BA...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x00000192BA3DFA00>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x00000192BA41BE90>
           │                └ <function get_categories at 0x00000192BA38A660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x00000192BA41BE90>
                 │             └ <function get_all_categories at 0x00000192BA38A840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 59, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 22:55:59.374 | ERROR    | app.crud.category_crud:get_all_categories:58 - Exception: 'Category' object is not subscriptable
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002A0E8634860>
    └ <WorkerThread(AnyIO worker thread, started 29096)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002A0EDB70C20>
    └ <WorkerThread(AnyIO worker thread, started 29096)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000002A0EDAC34C0>, db=<sqlalchemy.orm.session.Session object at 0x000002A0ED...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002A0EDB03F40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000002A0EDB30590>
           │                └ <function get_categories at 0x000002A0ECABA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000002A0EDB30590>
                 │             └ <function get_all_categories at 0x000002A0ECABA840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000002A0EDFA51D0>, <app.models.database.Category object at 0x000002A0EDFA5250>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000002A0EDFA51D0>
                       └ <app.models.database.Category object at 0x000002A0EDFA51D0>

TypeError: 'Category' object is not subscriptable
2024-11-07 22:55:59.382 | ERROR    | app.services.category_service:get_categories:53 - 
CATEGORIES HAVE NOT BEEN PARSED, EXCEPTION OCCURED: 500: An unexpected error occurred
Traceback (most recent call last):

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in get_all_categories
    categories_list = [category[0] for category in categories]
                                                   └ [<app.models.database.Category object at 0x000002A0EDFA51D0>, <app.models.database.Category object at 0x000002A0EDFA5250>, <a...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 52, in <listcomp>
    categories_list = [category[0] for category in categories]
                       │               └ <app.models.database.Category object at 0x000002A0EDFA51D0>
                       └ <app.models.database.Category object at 0x000002A0EDFA51D0>

TypeError: 'Category' object is not subscriptable


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002A0E8634860>
    └ <WorkerThread(AnyIO worker thread, started 29096)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000002A0EDB70C20>
    └ <WorkerThread(AnyIO worker thread, started 29096)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function list_categories at 0x000002A0EDAC34C0>, db=<sqlalchemy.orm.session.Session object at 0x000002A0ED...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000002A0EDB03F40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 79, in list_categories
    return category_service.get_categories(db=db)
           │                │                 └ <sqlalchemy.orm.session.Session object at 0x000002A0EDB30590>
           │                └ <function get_categories at 0x000002A0ECABA660>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 46, in get_categories
    categories = category_crud.get_all_categories(db=db)
                 │             │                     └ <sqlalchemy.orm.session.Session object at 0x000002A0EDB30590>
                 │             └ <function get_all_categories at 0x000002A0ECABA840>
                 └ <module 'app.crud.category_crud' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\crud\\cate...

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\crud\category_crud.py", line 59, in get_all_categories
    raise HTTPException(status_code=500, detail="An unexpected error occurred")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 500: An unexpected error occurred
2024-11-07 23:27:11.942 | ERROR    | app.services.user_service:create_user:45 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Username or email already in use
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x000001ED0E232480>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0B1C77...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E25A3C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_service.create_user(db=db, request=request, user=user)
           │            │              │           │             └ UserCreate(username='First56', email='firstUser56@gmail.com', password='Password1234$', role=None)
           │            │              │           └ <starlette.requests.Request object at 0x000001ED0E3D84D0>
           │            │              └ <sqlalchemy.orm.session.Session object at 0x000001ED0B1C7790>
           │            └ <function create_user at 0x000001ED0CDA4860>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 29, in create_user
    raise HTTPException(status_code=409, detail="Username or email already in use")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Username or email already in use
2024-11-07 23:27:13.242 | ERROR    | app.services.user_service:create_user:45 - 
USER ACCOUNT HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Username or email already in use
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_user at 0x000001ED0E232480>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0E3C4F...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E3C62C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 37, in create_user
    return user_service.create_user(db=db, request=request, user=user)
           │            │              │           │             └ UserCreate(username='First56', email='firstUser56@gmail.com', password='Password1234$', role=None)
           │            │              │           └ <starlette.requests.Request object at 0x000001ED0E3F8AD0>
           │            │              └ <sqlalchemy.orm.session.Session object at 0x000001ED0E3C4F90>
           │            └ <function create_user at 0x000001ED0CDA4860>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 29, in create_user
    raise HTTPException(status_code=409, detail="Username or email already in use")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Username or email already in use
2024-11-07 23:27:47.224 | ERROR    | app.services.user_service:update_user:111 - 
USER ACCOUNT HAS NOT BEEN CHANGED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function update_user_credentials at 0x000001ED0E232C00>, db=<sqlalchemy.orm.session.Session object at 0x00...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E24FF40>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 53, in update_user_credentials
    return user_service.update_user(db=db, username=username, data=data)
           │            │              │            │              └ UserUpdatePassword(email='firstUser56@gmail.comcs', password='Password1234$$', new_email='firstUser56@gmail.com', new_passwor...
           │            │              │            └ 'First56'
           │            │              └ <sqlalchemy.orm.session.Session object at 0x000001ED0E242E50>
           │            └ <function update_user at 0x000001ED0CEEA340>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 100, in update_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 23:28:12.392 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001ED0E233100>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0E...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E27DF80>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 71, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija19', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001ED0E24FED0>
           │                └ <function create_category at 0x000001ED0CEEA5C0>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 23:28:52.864 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001ED0E233100>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0E...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E46EBC0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 71, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija20', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001ED0E5B3290>
           │                └ <function create_category at 0x000001ED0CEEA5C0>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
2024-11-07 23:29:18.354 | ERROR    | app.services.user_service:remove_user:139 - 
USER ACCOUNT HAS NOT BEEN REMOVED, EXCEPTION OCCURED: 404: User not found
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function delete_user at 0x000001ED0E232E80>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0E3DF1...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E4588C0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 61, in delete_user
    return user_service.remove_user(db=db, username=username, data=data)
           │            │              │            │              └ UserDelete(email='firstUser56@gmail.com', password='Password1234$')
           │            │              │            └ 'First56'
           │            │              └ <sqlalchemy.orm.session.Session object at 0x000001ED0E3DF150>
           │            └ <function remove_user at 0x000001ED0CEEA3E0>
           └ <module 'app.services.user_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\service...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\user_service.py", line 131, in remove_user
    raise HTTPException(status_code=404, detail="User not found")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 404: User not found
2024-11-07 23:29:27.436 | ERROR    | app.services.category_service:create_category:37 - 
CATEGORY HAS NOT BEEN CREATED, EXCEPTION OCCURED: 409: Category already exists
Traceback (most recent call last):

  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1002, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001ED08AD4860>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\threading.py", line 1045, in _bootstrap_inner
    self.run()
    │    └ <function WorkerThread.run at 0x000001ED0E2E0E00>
    └ <WorkerThread(AnyIO worker thread, started 15728)>
  File "C:\Users\tomas\AppData\Local\Programs\Python\Python311\Lib\site-packages\anyio\_backends\_asyncio.py", line 914, in run
    result = context.run(func, *args)
             │       │   │      └ ()
             │       │   └ functools.partial(<function create_category at 0x000001ED0E233100>, db=<sqlalchemy.orm.session.Session object at 0x000001ED0E...
             │       └ <method 'run' of '_contextvars.Context' objects>
             └ <_contextvars.Context object at 0x000001ED0E5CAFC0>

  File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\main.py", line 71, in create_category
    return category_service.create_category(db=db, category=category)
           │                │                  │            └ CategoryCreate(name='Kategorija20', description='Kategorijos aprasymas.')
           │                │                  └ <sqlalchemy.orm.session.Session object at 0x000001ED0E5C9590>
           │                └ <function create_category at 0x000001ED0CEEA5C0>
           └ <module 'app.services.category_service' from 'C:\\Users\\tomas\\Documents\\Saityno Progr. Projektavimas\\StreamaBit\\app\\ser...

> File "C:\Users\tomas\Documents\Saityno Progr. Projektavimas\StreamaBit\app\services\category_service.py", line 23, in create_category
    raise HTTPException(status_code=409, detail="Category already exists")
          └ <class 'fastapi.exceptions.HTTPException'>

fastapi.exceptions.HTTPException: 409: Category already exists
